<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remake AI</title>
    <link rel="icon" href="images/png2.png" type="image/png">
    <style>
        :root {
            --text-size: 1rem;
            --button-scale: 1;
            --accent-light: #c1d8f4;
            --accent-primary: #0483e4;
            --accent-dark: #046bd4;
            --background-color: #f4f8fd;
            --text-color: #23272c;
            --card-bg: #ffffff;
            --border-color: #d8e6f8;
            --shadow: 0 5px 15px rgba(4, 107, 212, 0.08);
            --settings-text-size: 1rem;
            --button-text-color: white;
            --button-bg: linear-gradient(to right, #003CC5 0%, #0B63F6 51%, #003CC5 100%);
            --white-to-gray: #ffffff;
        }

        .dark-theme {
            --background-color: #0a0e14;
            --text-color: #e1e7ef;
            --card-bg: #1a1f29;
            --border-color: #2a3242;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            --button-text-color: #ffffff;
            --button-bg: linear-gradient(to right, #003CC5 0%, #0B63F6 51%, #003CC5 100%);
            --white-to-gray: #a0a0a0;
        }

        .colorblind-theme {
            --accent-primary: #0072B2;
            --accent-dark: #E69F00;
            --accent-light: #56B4E9;
            --button-bg: linear-gradient(to right, #0072B2 0%, #56B4E9 51%, #0072B2 100%);
            --button-text-color: #ffffff;
        }

        .colorblind-theme.dark-theme {
            --accent-primary: #56B4E9;
            --accent-dark: #F0E442;
            --accent-light: #0072B2;
            --button-bg: linear-gradient(to right, #56B4E9 0%, #F0E442 51%, #56B4E9 100%);
            --button-text-color: #0a0e14;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            font-size: var(--text-size);
            transition: all 0.3s ease;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        textarea,
        textarea * {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        img {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }
        
        .floating-circle {
            position: fixed;
            top: -30px;
            border-radius: 50%;
            opacity: 0.6;
            pointer-events: none;
            z-index: 9998;
            animation: fall linear forwards;
        }

        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.6; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .floating-circle.bubbles {
            background: radial-gradient(circle at 30% 30%, rgba(193,216,244,0.8), rgba(4,131,228,0.4));
            box-shadow: 0 0 10px rgba(4,131,228,0.3);
        }

        .floating-circle.hearts {
            background: transparent;
            font-size: 20px;
            text-align: center;
            line-height: 1;
            color: #ff6b6b;
        }

        .floating-circle.snow {
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9), rgba(240,240,240,0.6));
            box-shadow: 0 0 8px rgba(255,255,255,0.5);
        }

        .floating-circle.stars {
            background: radial-gradient(circle at 30% 30%, rgba(255,255,0,0.8), rgba(255,215,0,0.4));
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        }

        .language-selector {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .language-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            font-weight: bold;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .language-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .language-dropdown {
            position: absolute;
            bottom: 60px;
            right: 0;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: var(--shadow);
            min-width: 150px;
            display: none;
            overflow: hidden;
        }

        .language-dropdown.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .language-option {
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-bottom: 1px solid var(--border-color);
        }

        .language-option:last-child {
            border-bottom: none;
        }

        .language-option:hover {
            background-color: rgba(0, 114, 178, 0.05);
        }

        .language-option.selected {
            background-color: rgba(0, 114, 178, 0.1);
            color: var(--accent-primary);
        }

        .language-flag {
            font-size: 1rem;
            font-weight: bold;
            width: 20px;
            text-align: center;
        }

        .language-name {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .language-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 12px;
            height: 12px;
            background: var(--accent-primary);
            border-radius: 50%;
            border: 2px solid var(--card-bg);
            transition: all 0.3s ease;
            opacity: 0;
        }

        .language-indicator.active {
            opacity: 1;
            transform: scale(1.2);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 2;
        }
        
        header {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-dark) 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(4, 107, 212, 0.15);
            position: relative;
            z-index: 3;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: contain;
            pointer-events: none;
        }
        
        .logo {
            font-size: calc(var(--text-size) * 1.75);
            font-weight: 700;
            color: white;
        }
        
        .settings-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--card-bg);
            border: none;
            border-radius: 8px;
            width: 50px;
            height: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: var(--accent-primary);
            transition: all 0.3s ease;
            opacity: 0.9;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }
        
        .settings-btn:hover {
            opacity: 1;
            background: var(--accent-light);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        .settings-btn:hover .settings-icon {
            animation: rotate 2s linear infinite;
        }
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        .settings-icon {
            width: 28px;
            height: 28px;
            fill: currentColor;
            transition: transform 0.3s ease;
        }
        
        .settings-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            width: 350px;
            padding: 0;
            overflow: hidden;
            display: none;
            border: 1px solid var(--border-color);
            font-size: var(--settings-text-size);
        }
        
        .settings-panel.active {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .settings-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-dark) 100%);
            color: white;
        }
        
        .settings-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0;
        }
        
        .settings-cell {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
        }
        
        .settings-cell:hover {
            background-color: rgba(0, 114, 178, 0.05);
        }
        
        .colorblind-theme .settings-cell:hover {
            background-color: rgba(230, 159, 0, 0.05);
        }
        
        .dark-theme .settings-cell:hover {
            background-color: #252c3a;
        }
        
        .settings-cell:last-child {
            border-bottom: none;
        }
        
        .cell-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .cell-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
        }
        
        .cell-arrow {
            color: var(--accent-primary);
            transition: transform 0.3s;
            font-size: 0.9rem;
        }
        
        .cell-arrow.rotated {
            transform: rotate(180deg);
        }
        
        .cell-content {
            display: none;
        }
        
        .cell-content.active {
            display: block;
        }
        
        .control-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .control-btn {
            padding: 10px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            color: var(--text-color);
        }
        
        .control-btn:hover {
            background: var(--accent-light);
            border-color: var(--accent-primary);
            color: var(--text-color);
        }
        
        .colorblind-theme .control-btn:hover {
            background: rgba(86, 180, 233, 0.1);
            border-color: var(--accent-primary);
        }
        
        .size-indicator {
            text-align: center;
            font-size: 0.9rem;
            color: var(--accent-primary);
            font-weight: 600;
            margin-top: 5px;
            grid-column: 1 / -1;
        }
        
        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(0, 114, 178, 0.05);
            border-radius: 8px;
        }
        
        .colorblind-theme .toggle-group {
            background: rgba(230, 159, 0, 0.05);
        }
        
        .dark-theme .toggle-group {
            background: #252c3a;
        }
        
        .toggle-label {
            font-weight: 500;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--accent-primary);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        
        .reset-btn {
            width: 100%;
            padding: 12px;
            background: transparent;
            color: var(--accent-primary);
            border: 1px solid var(--accent-primary);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .reset-btn:hover {
            background: var(--accent-primary);
            color: var(--button-text-color);
        }
        
        .background-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
            padding: 5px;
        }
        
        .background-option {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .background-option:hover,
        .background-option.selected {
            border-color: var(--accent-primary);
        }
        
        .bg-preview {
            width: 100%;
            height: 40px;
            border-radius: 4px;
            margin-bottom: 5px;
            border: 1px solid var(--border-color);
        }
        
        .bg-name {
            font-size: 0.7rem;
            font-weight: 500;
        }
        
        .effects-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .effect-option {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .effect-option:hover,
        .effect-option.selected {
            border-color: var(--accent-primary);
            background-color: rgba(0, 114, 178, 0.05);
        }
        
        .effect-preview {
            width: 100%;
            height: 60px;
            border-radius: 4px;
            margin-bottom: 8px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--text-color);
            opacity: 0.7;
        }
        
        .effect-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .effect-desc {
            font-size: 0.75rem;
            color: var(--text-color);
            opacity: 0.7;
        }
        
        .main-content {
            display: flex;
            gap: 40px;
            margin: 40px 0;
        }
        
        .input-section, .preview-section {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }
        
        .input-section {
            flex: 1;
            min-width: 0;
        }
        
        .preview-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 500px;
            max-height: 700px;
            resize: none;
            overflow: hidden;
        }
        
        .section-title {
            font-size: calc(var(--text-size) * 1.5);
            margin-bottom: 20px;
            color: var(--text-color);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        
        textarea {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: var(--text-size);
            resize: vertical;
            min-height: 120px;
            max-height: 300px;
            transition: border 0.3s;
            background: var(--card-bg);
            color: var(--text-color);
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(0, 114, 178, 0.1);
        }
        
        .styles-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .style-option {
            position: relative;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--card-bg);
        }
        
        .style-option:hover {
            border-color: var(--accent-primary);
            background-color: rgba(0, 114, 178, 0.05);
        }
        
        .colorblind-theme .style-option:hover {
            background-color: rgba(230, 159, 0, 0.05);
        }
        
        .style-option.selected {
            border-color: var(--accent-primary);
            background-color: rgba(0, 114, 178, 0.1);
        }
        
        .colorblind-theme .style-option.selected {
            background-color: rgba(230, 159, 0, 0.1);
        }
        
        .style-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-color);
        }
        
        .style-desc {
            font-size: calc(var(--text-size) * 0.875);
            color: var(--text-color);
            opacity: 0.7;
        }
        
        .generate-btn {
            display: block;
            width: 100%;
            color: var(--button-text-color);
            border: none;
            padding: calc(15px * var(--button-scale));
            border-radius: 10px;
            font-size: calc(var(--text-size) * 1.125);
            font-weight: 600;
            cursor: pointer;
            transition: 0.5s;
            margin-top: 10px;
            transform: scale(var(--button-scale));
            text-align: center;
            background-size: 200% auto;
            box-shadow: 0 4px 15px rgba(0, 60, 197, 0.3);
            background-image: var(--button-bg);
        }
        
        .generate-btn:hover {
            transform: translateY(-2px) scale(var(--button-scale));
            background-position: right center;
            box-shadow: 0 6px 20px rgba(0, 60, 197, 0.4);
        }
        
        .preview-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 300px;
            max-height: 500px;
            overflow: hidden;
        }
        
        .preview-placeholder {
            flex: 1;
            background-color: rgba(0, 114, 178, 0.05);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-color);
            opacity: 0.7;
            font-size: var(--text-size);
            text-align: center;
            padding: 20px;
            min-height: 300px;
            resize: none;
            overflow: auto;
        }
        
        .colorblind-theme .preview-placeholder {
            background-color: rgba(230, 159, 0, 0.05);
        }
        
        .dark-theme .preview-placeholder {
            background-color: #252c3a;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
            display: none;
            object-fit: contain;
            pointer-events: none;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 5px solid var(--border-color);
            border-top: 5px solid var(--accent-primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .service-info {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin: 40px 0;
            border: 1px solid var(--border-color);
        }
        
        .service-info h2 {
            font-size: calc(var(--text-size) * 1.75);
            margin-bottom: 20px;
            color: var(--text-color);
            text-align: center;
        }
        
        .service-info p {
            font-size: calc(var(--text-size) * 1.125);
            color: var(--text-color);
            margin-bottom: 15px;
            text-align: center;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        footer {
            background: var(--accent-dark);
            color: white;
            padding: 30px 0;
            text-align: center;
            position: relative;
            z-index: 3;
        }
        
        .dark-theme footer {
            background: var(--accent-dark);
            color: white;
        }
        
        .colorblind-theme footer {
            background: var(--accent-dark);
            color: white;
        }
        
        .download-btn {
            display: block;
            width: 100%;
            color: var(--button-text-color);
            border: none;
            padding: calc(12px * var(--button-scale));
            border-radius: 8px;
            font-size: calc(var(--text-size) * 1);
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 15px;
            transform: scale(var(--button-scale));
            text-align: center;
            background-size: 200% auto;
            box-shadow: 0 2px 10px rgba(0, 60, 197, 0.2);
            background-image: var(--button-bg);
        }
        
        .download-btn:hover {
            transform: translateY(-1px) scale(var(--button-scale));
            background-position: right center;
            box-shadow: 0 4px 15px rgba(0, 60, 197, 0.3);
        }
        
        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: scale(var(--button-scale));
        }
        
        .download-btn:disabled:hover {
            transform: scale(var(--button-scale));
            background-position: left center;
        }
        
        .image-info {
            margin-top: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            font-size: 0.8rem;
            color: var(--text-color);
            opacity: 0.8;
        }
        
        .image-info div {
            margin-bottom: 5px;
        }
        
        .image-info strong {
            color: var(--accent-primary);
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .styles-grid {
                grid-template-columns: 1fr;
            }
            
            .settings-panel {
                width: 300px;
                right: 10px;
            }
            
            .logo {
                font-size: calc(var(--text-size) * 1.5);
            }
            
            .logo-img {
                width: 40px;
                height: 40px;
            }
            
            .preview-section {
                min-height: 400px;
                max-height: 500px;
            }
            
            .settings-btn {
                width: 45px;
                height: 45px;
            }
            
            .settings-icon {
                width: 24px;
                height: 24px;
            }
            
            .background-options {
                grid-template-columns: 1fr 1fr;
            }
            
            .language-dropdown {
                right: -50px;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-container">
                    <img src="images/png1.png" alt="Логотип сайта" class="logo-img">
                    <div class="logo" data-i18n="siteTitle">Remake AI</div>
                </div>
            </div>
        </div>
    </header>

    <button class="settings-btn" id="settingsBtn">
        <svg class="settings-icon" viewBox="0 0 24 24">
            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
        </svg>
    </button>

    <div class="language-selector">
        <div class="language-btn" id="languageBtn">
            <span id="currentLanguageFlag">RU</span>
            <div class="language-indicator" id="languageIndicator"></div>
        </div>
        <div class="language-dropdown" id="languageDropdown">
            <div class="language-option selected" data-lang="ru">
                <span class="language-flag">RU</span>
                <span class="language-name">Русский</span>
            </div>
            <div class="language-option" data-lang="en">
                <span class="language-flag">EN</span>
                <span class="language-name">English</span>
            </div>
            <div class="language-option" data-lang="zh">
                <span class="language-flag">CN</span>
                <span class="language-name">中文</span>
            </div>
            <div class="language-option" data-lang="ko">
                <span class="language-flag">KR</span>
                <span class="language-name">한국어</span>
            </div>
            <div class="language-option" data-lang="ja">
                <span class="language-flag">JP</span>
                <span class="language-name">日本語</span>
            </div>
            <div class="language-option" data-lang="ar">
                <span class="language-flag">AR</span>
                <span class="language-name">العربية</span>
            </div>
            <div class="language-option" data-lang="es">
                <span class="language-flag">ES</span>
                <span class="language-name">Español</span>
            </div>
            <div class="language-option" data-lang="fr">
                <span class="language-flag">FR</span>
                <span class="language-name">Français</span>
            </div>
            <div class="language-option" data-lang="de">
                <span class="language-flag">DE</span>
                <span class="language-name">Deutsch</span>
            </div>
            <div class="language-option" data-lang="pt">
                <span class="language-flag">PT</span>
                <span class="language-name">Português</span>
            </div>
            <div class="language-option" data-lang="hi">
                <span class="language-flag">IN</span>
                <span class="language-name">हिन्दी</span>
            </div>
        </div>
    </div>
    
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h3 class="settings-title" data-i18n="settings.title">Настройки доступности</h3>
        </div>
        
        <div class="settings-grid">
            <div class="settings-cell">
                <div class="cell-header" data-cell="text">
                    <div class="cell-title" data-i18n="settings.text">Текст</div>
                    <div class="cell-arrow">▼</div>
                </div>
                <div class="cell-content" id="text-cell">
                    <div class="control-group">
                        <button class="control-btn" id="decreaseText">
                            <span>-</span> <span data-i18n="settings.decrease">Уменьшить</span>
                        </button>
                        <button class="control-btn" id="increaseText">
                            <span>+</span> <span data-i18n="settings.increase">Увеличить</span>
                        </button>
                        <div class="size-indicator" id="textSizeIndicator">100%</div>
                    </div>
                </div>
            </div>
            
            <div class="settings-cell">
                <div class="cell-header" data-cell="buttons">
                    <div class="cell-title" data-i18n="settings.buttons">Кнопки</div>
                    <div class="cell-arrow">▼</div>
                </div>
                <div class="cell-content" id="buttons-cell">
                    <div class="control-group">
                        <button class="control-btn" id="decreaseButtons">
                            <span>-</span> <span data-i18n="settings.decrease">Уменьшить</span>
                        </button>
                        <button class="control-btn" id="increaseButtons">
                            <span>+</span> <span data-i18n="settings.increase">Увеличить</span>
                        </button>
                        <div class="size-indicator" id="buttonSizeIndicator">100%</div>
                    </div>
                </div>
            </div>
            
            <div class="settings-cell">
                <div class="cell-header" data-cell="background">
                    <div class="cell-title" data-i18n="settings.background">Фон страницы</div>
                    <div class="cell-arrow">▼</div>
                </div>
                <div class="cell-content" id="background-cell">
                    <div class="background-options">
                        <div class="background-option selected" data-bg="default">
                            <div class="bg-preview" style="background: var(--background-color);"></div>
                            <div class="bg-name" data-i18n="settings.default">По умолчанию</div>
                        </div>
                        <div class="background-option" data-bg="pattern1">
                            <div class="bg-preview" style="background: linear-gradient(45deg, #f4f8fd 25%, transparent 25%), linear-gradient(-45deg, #f4f8fd 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #f4f8fd 75%), linear-gradient(-45deg, transparent 75%, #f4f8fd 75%); background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px;"></div>
                            <div class="bg-name">Узор 1</div>
                        </div>
                        <div class="background-option" data-bg="pattern2">
                            <div class="bg-preview" style="background: radial-gradient(circle, #d8e6f8 1px, transparent 1px); background-size: 20px 20px;"></div>
                            <div class="bg-name">Узор 2</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-cell">
                <div class="cell-header" data-cell="effects">
                    <div class="cell-title" data-i18n="settings.effects">Эффекты</div>
                    <div class="cell-arrow">▼</div>
                </div>
                <div class="cell-content" id="effects-cell">
                    <div class="effects-options">
                        <div class="effect-option selected" data-effect="none">
                            <div class="effect-preview" data-i18n="effects.none">Без эффектов</div>
                            <div class="effect-name" data-i18n="effects.off">Выключено</div>
                            <div class="effect-desc" data-i18n="effects.offDesc">Отключить все анимации</div>
                        </div>
                        <div class="effect-option" data-effect="bubbles">
                            <div class="effect-preview" data-i18n="effects.bubbles">Пузырьки</div>
                            <div class="effect-name" data-i18n="effects.bubbles">Пузырьки</div>
                            <div class="effect-desc" data-i18n="effects.bubblesDesc">Плавающие разноцветные круги</div>
                        </div>
                        <div class="effect-option" data-effect="hearts">
                            <div class="effect-preview">♥ Сердечки</div>
                            <div class="effect-name" data-i18n="effects.hearts">Сердечки</div>
                            <div class="effect-desc" data-i18n="effects.heartsDesc">Падающие сердечки</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="settings-cell">
                <div class="cell-header" data-cell="display">
                    <div class="cell-title" data-i18n="settings.display">Отображение</div>
                    <div class="cell-arrow">▼</div>
                </div>
                <div class="cell-content" id="display-cell">
                    <div class="toggle-group">
                        <span class="toggle-label" data-i18n="settings.colorblind">Режим для дальтоников</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="colorblindToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="toggle-group">
                        <span class="toggle-label" data-i18n="settings.darkTheme">Тёмная тема</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="themeToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="settings-cell">
                <button class="reset-btn" id="resetSettings" data-i18n="settings.reset">Сбросить настройки</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title" data-i18n="main.createImage">Создайте ваше изображение</h2>
                
                <div class="input-group">
                    <label for="prompt" data-i18n="main.describeImage">Опишите ваше изображение:</label>
                    <textarea id="prompt" data-i18n="main.promptPlaceholder" placeholder="Например: Красивый закат над горным озером с отражением в воды"></textarea>
                </div>
                
                <div class="input-group">
                    <label data-i18n="main.chooseStyle">Выберите стиль:</label>
                    <div class="styles-grid">
                        <div class="style-option selected" data-style="realism">
                            <div class="style-name" data-i18n="styles.realism">Реализм</div>
                            <div class="style-desc" data-i18n="styles.realismDesc">Фотографически точные изображения</div>
                        </div>
                        <div class="style-option" data-style="concept">
                            <div class="style-name" data-i18n="styles.concept">Концепт-арт</div>
                            <div class="style-desc" data-i18n="styles.conceptDesc">Креативные концепции для игр и фильмов</div>
                        </div>
                        <div class="style-option" data-style="minimalism">
                            <div class="style-name" data-i18n="styles.minimalism">Минимализм</div>
                            <div class="style-desc" data-i18n="styles.minimalismDesc">Простота и элегантность</div>
                        </div>
                        <div class="style-option" data-style="anime">
                            <div class="style-name" data-i18n="styles.anime">Аниме</div>
                            <div class="style-desc" data-i18n="styles.animeDesc">В стиле японской анимации</div>
                        </div>
                    </div>
                </div>
                
                <button class="generate-btn" id="generateBtn" data-i18n="main.generate">Сгенерировать изображение</button>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title" data-i18n="main.preview">Предпросмотр</h2>
                
                <div class="preview-container">
                    <div class="preview-placeholder" id="previewPlaceholder" data-i18n="main.previewPlaceholder">
                        Здесь появится ваше сгенерированное изображение
                    </div>
                    
                    <img class="preview-image" id="previewImage" src="" alt="Сгенерированное изображение">
                    
                    <div class="loading" id="loadingIndicator">
                        <div class="spinner"></div>
                        <p data-i18n="main.generating">Генерируем ваше изображение...</p>
                    </div>
                </div>
                
                <div class="image-info" id="imageInfo" style="display: none;">
                    <div><strong data-i18n="main.source">Источник:</strong> <span id="imageSource">-</span></div>
                    <div><strong data-i18n="main.model">Модель:</strong> <span id="imageModel">-</span></div>
                    <div><strong data-i18n="main.generationTime">Время генерации:</strong> <span id="imageGenerationTime">-</span>ms</div>
                </div>
                
                <button class="download-btn" id="downloadBtn" disabled data-i18n="main.download">Скачать изображение</button>
            </div>
        </div>
        
        <div class="service-info">
            <h2 data-i18n="info.title">Создавайте изображения за 30 секунд</h2>
            <p data-i18n="info.description1">Наш сервис использует передовые технологии искусственного интеллекта для преобразования ваших текстовых описаний в уникальные изображения. Просто опишите, что вы хотите увидеть, выберите стиль и нажмите "Сгенерировать".</p>
            <p data-i18n="info.description2">Всего за 30 секунд вы получите готовое изображение, которое можно использовать для личных или коммерческих проектов. Не требуется никаких навыков рисования или дизайна - просто ваше воображение и наш AI.</p>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; Remake AI. <span data-i18n="footer.rights">Все права защищены.</span></p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Основные элементы DOM
            const styleOptions = document.querySelectorAll('.style-option');
            const generateBtn = document.getElementById('generateBtn');
            const previewPlaceholder = document.getElementById('previewPlaceholder');
            const previewImage = document.getElementById('previewImage');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const downloadBtn = document.getElementById('downloadBtn');
            const imageInfo = document.getElementById('imageInfo');
            const imageSource = document.getElementById('imageSource');
            const imageModel = document.getElementById('imageModel');
            const imageGenerationTime = document.getElementById('imageGenerationTime');
            
            // Настройки доступности
            const settingsBtn = document.getElementById('settingsBtn');
            const settingsPanel = document.getElementById('settingsPanel');
            const cellHeaders = document.querySelectorAll('.cell-header');
            const decreaseTextBtn = document.getElementById('decreaseText');
            const increaseTextBtn = document.getElementById('increaseText');
            const textSizeIndicator = document.getElementById('textSizeIndicator');
            const decreaseButtonsBtn = document.getElementById('decreaseButtons');
            const increaseButtonsBtn = document.getElementById('increaseButtons');
            const buttonSizeIndicator = document.getElementById('buttonSizeIndicator');
            const colorblindToggle = document.getElementById('colorblindToggle');
            const themeToggle = document.getElementById('themeToggle');
            const resetSettingsBtn = document.getElementById('resetSettings');
            const backgroundOptions = document.querySelectorAll('.background-option');
            const effectOptions = document.querySelectorAll('.effect-option');
            
            // Языковые настройки
            const languageBtn = document.getElementById('languageBtn');
            const languageDropdown = document.getElementById('languageDropdown');
            const currentLanguageFlag = document.getElementById('currentLanguageFlag');
            const languageOptions = document.querySelectorAll('.language-option');
            const languageIndicator = document.getElementById('languageIndicator');
            
            // Состояние приложения
            let selectedStyle = 'realism';
            let textSize = 1;
            let buttonScale = 1;
            let isColorblindMode = false;
            let isDarkTheme = false;
            let currentBackground = 'default';
            let currentEffect = 'none';
            let effectInterval = null;
            let currentLanguage = 'ru';
            let currentImageUrl = null;
            let languageChanged = false;
            let variationCount = 0;

            // Переводы
            const translations = {
                ru: {
                    siteTitle: "Remake AI",
                    settings: {
                        title: "Настройки доступности",
                        text: "Текст",
                        buttons: "Кнопки",
                        background: "Фон страницы",
                        effects: "Эффекты",
                        display: "Отображение",
                        decrease: "Уменьшить",
                        increase: "Увеличить",
                        default: "По умолчанию",
                        colorblind: "Режим для дальтоников",
                        darkTheme: "Тёмная тема",
                        reset: "Сбросить настройки"
                    },
                    effects: {
                        none: "Без эффектов",
                        off: "Выключено",
                        offDesc: "Отключить все анимации",
                        bubbles: "Пузырьки",
                        bubblesDesc: "Плавающие разноцветные круги",
                        hearts: "Сердечки",
                        heartsDesc: "Падающие сердечки"
                    },
                    main: {
                        createImage: "Создайте ваше изображение",
                        describeImage: "Опишите ваше изображение:",
                        promptPlaceholder: "Например: Красивый закат над горным озером с отражением в воде",
                        chooseStyle: "Выберите стиль:",
                        generate: "Сгенерировать изображение",
                        preview: "Предпросмотр",
                        previewPlaceholder: "Здесь появится ваше сгенерированное изображение",
                        generating: "Генерируем ваше изображение...",
                        download: "Скачать изображение",
                        source: "Источник",
                        model: "Модель",
                        generationTime: "Время генерации"
                    },
                    styles: {
                        realism: "Реализм",
                        realismDesc: "Фотографически точные изображения",
                        concept: "Концепт-арт",
                        conceptDesc: "Креативные концепции для игр и фильмов",
                        minimalism: "Минимализм",
                        minimalismDesc: "Простота и элегантность",
                        anime: "Аниме",
                        animeDesc: "В стиле японской анимации"
                    },
                    info: {
                        title: "Создавайте изображения за 30 секунд",
                        description1: "Наш сервис использует передовые технологии искусственного интеллекта для преобразования ваших текстовых описаний в уникальные изображения. Просто опишите, что вы хотите увидеть, выберите стиль и нажмите 'Сгенерировать'.",
                        description2: "Всего за 30 секунд вы получите готовое изображение, которое можно использовать для личных или коммерческих проектов. Не требуется никаких навыков рисования или дизайна - просто ваше воображение и наш AI."
                    },
                    footer: {
                        rights: "Все права защищены."
                    }
                },
                en: {
                    siteTitle: "Remake AI",
                    settings: {
                        title: "Accessibility Settings",
                        text: "Text",
                        buttons: "Buttons",
                        background: "Page Background",
                        effects: "Effects",
                        display: "Display",
                        decrease: "Decrease",
                        increase: "Increase",
                        default: "Default",
                        colorblind: "Colorblind Mode",
                        darkTheme: "Dark Theme",
                        reset: "Reset Settings"
                    },
                    effects: {
                        none: "No Effects",
                        off: "Disabled",
                        offDesc: "Disable all animations",
                        bubbles: "Bubbles",
                        bubblesDesc: "Floating colored circles",
                        hearts: "Hearts",
                        heartsDesc: "Falling hearts"
                    },
                    main: {
                        createImage: "Create Your Image",
                        describeImage: "Describe your image:",
                        promptPlaceholder: "For example: Beautiful sunset over a mountain lake with reflection in water",
                        chooseStyle: "Choose style:",
                        generate: "Generate Image",
                        preview: "Preview",
                        previewPlaceholder: "Your generated image will appear here",
                        generating: "Generating your image...",
                        download: "Download Image",
                        source: "Source",
                        model: "Model",
                        generationTime: "Generation time"
                    },
                    styles: {
                        realism: "Realism",
                        realismDesc: "Photographically accurate images",
                        concept: "Concept Art",
                        conceptDesc: "Creative concepts for games and movies",
                        minimalism: "Minimalism",
                        minimalismDesc: "Simplicity and elegance",
                        anime: "Anime",
                        animeDesc: "In Japanese animation style"
                    },
                    info: {
                        title: "Create Images in 30 Seconds",
                        description1: "Our service uses advanced artificial intelligence technologies to transform your text descriptions into unique images. Just describe what you want to see, choose a style and click 'Generate'.",
                        description2: "In just 30 seconds you'll get a ready-made image that can be used for personal or commercial projects. No drawing or design skills required - just your imagination and our AI."
                    },
                    footer: {
                        rights: "All rights reserved."
                    }
                }
            };

            const flagMap = {
                'ru': 'RU',
                'en': 'EN',
                'zh': 'CN',
                'ko': 'KR',
                'ja': 'JP',
                'ar': 'AR',
                'es': 'ES',
                'fr': 'FR',
                'de': 'DE',
                'pt': 'PT',
                'hi': 'IN'
            };

            // Функция установки языка
            function setLanguage(lang) {
                currentLanguage = lang;
                document.documentElement.lang = lang;
                currentLanguageFlag.textContent = flagMap[lang];
                
                if (languageChanged) {
                    languageIndicator.classList.add('active');
                    setTimeout(() => {
                        languageIndicator.classList.remove('active');
                    }, 2000);
                }
                
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const keys = key.split('.');
                    let translation = translations[lang];
                    
                    for (const k of keys) {
                        translation = translation?.[k];
                    }
                    
                    if (translation) {
                        if (element.hasAttribute('placeholder')) {
                            element.setAttribute('placeholder', translation);
                        } else if (element.hasAttribute('alt') && element.getAttribute('alt') === '') {
                            element.setAttribute('alt', translation);
                        } else {
                            element.textContent = translation;
                        }
                    }
                });

                languageOptions.forEach(option => {
                    option.classList.remove('selected');
                    if (option.getAttribute('data-lang') === lang) {
                        option.classList.add('selected');
                    }
                });

                localStorage.setItem('language', lang);
                languageChanged = true;
            }

            // Инициализация настроек
            function initializeSettings() {
                const savedTextSize = localStorage.getItem('textSize');
                const savedButtonScale = localStorage.getItem('buttonScale');
                const savedColorblindMode = localStorage.getItem('colorblindMode');
                const savedDarkTheme = localStorage.getItem('darkTheme');
                const savedBackground = localStorage.getItem('background');
                const savedEffect = localStorage.getItem('effect');
                const savedLanguage = localStorage.getItem('language');
                
                if (savedTextSize) {
                    textSize = parseFloat(savedTextSize);
                    updateTextSizeIndicator();
                    updateTextSize();
                }
                
                if (savedButtonScale) {
                    buttonScale = parseFloat(savedButtonScale);
                    updateButtonSizeIndicator();
                    updateButtonSize();
                }
                
                if (savedColorblindMode === 'true') {
                    isColorblindMode = true;
                    colorblindToggle.checked = true;
                    document.body.classList.add('colorblind-theme');
                }
                
                if (savedDarkTheme === 'true') {
                    isDarkTheme = true;
                    themeToggle.checked = true;
                    document.body.classList.add('dark-theme');
                }
                
                if (savedBackground) {
                    currentBackground = savedBackground;
                    applyBackground(currentBackground);
                    selectBackgroundOption(currentBackground);
                }
                
                if (savedEffect) {
                    currentEffect = savedEffect;
                    applyEffect(currentEffect);
                    selectEffectOption(savedEffect);
                }

                if (savedLanguage && translations[savedLanguage]) {
                    currentLanguage = savedLanguage;
                    setLanguage(savedLanguage);
                }
            }
            
            function updateTextSize() {
                document.documentElement.style.setProperty('--text-size', textSize + 'rem');
                localStorage.setItem('textSize', textSize);
            }
            
            function updateTextSizeIndicator() {
                textSizeIndicator.textContent = Math.round(textSize * 100) + '%';
            }
            
            function updateButtonSize() {
                document.documentElement.style.setProperty('--button-scale', buttonScale);
                localStorage.setItem('buttonScale', buttonScale);
            }
            
            function updateButtonSizeIndicator() {
                buttonSizeIndicator.textContent = Math.round(buttonScale * 100) + '%';
            }
            
            function applyBackground(bgType) {
                const body = document.body;
                body.style.background = '';
                body.style.backgroundColor = '';
                
                if (bgType === 'default') {
                    body.style.backgroundColor = 'var(--background-color)';
                } else if (bgType === 'pattern1') {
                    body.style.background = 'linear-gradient(45deg, var(--background-color) 25%, transparent 25%), linear-gradient(-45deg, var(--background-color) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, var(--background-color) 75%), linear-gradient(-45deg, transparent 75%, var(--background-color) 75%)';
                    body.style.backgroundSize = '20px 20px';
                    body.style.backgroundPosition = '0 0, 0 10px, 10px -10px, -10px 0px';
                } else if (bgType === 'pattern2') {
                    body.style.background = 'radial-gradient(circle, var(--border-color) 1px, transparent 1px)';
                    body.style.backgroundSize = '20px 20px';
                }
                
                localStorage.setItem('background', bgType);
            }
            
            function selectBackgroundOption(bgType) {
                backgroundOptions.forEach(option => {
                    option.classList.remove('selected');
                });
                
                const selectedOption = document.querySelector(`[data-bg="${bgType}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
            }
            
            function applyEffect(effectType) {
                stopEffects();
                currentEffect = effectType;
                
                switch(effectType) {
                    case 'bubbles':
                        effectInterval = setInterval(createBubble, 200);
                        break;
                    case 'hearts':
                        effectInterval = setInterval(createHeart, 300);
                        break;
                }
                
                localStorage.setItem('effect', effectType);
            }
            
            function stopEffects() {
                if (effectInterval) {
                    clearInterval(effectInterval);
                    effectInterval = null;
                }
            }
            
            function createBubble() {
                const circle = document.createElement('div');
                circle.classList.add('floating-circle', 'bubbles');
                const size = 15 + Math.random() * 25;
                circle.style.width = circle.style.height = size + 'px';
                circle.style.left = Math.random() * window.innerWidth + 'px';
                circle.style.animationDuration = (4 + Math.random() * 6) + 's';
                document.body.appendChild(circle);

                circle.addEventListener('animationend', () => {
                    circle.remove();
                });
            }
            
            function createHeart() {
                const circle = document.createElement('div');
                circle.classList.add('floating-circle', 'hearts');
                const size = 20 + Math.random() * 20;
                circle.style.width = circle.style.height = size + 'px';
                circle.style.left = Math.random() * window.innerWidth + 'px';
                circle.style.animationDuration = (5 + Math.random() * 5) + 's';
                circle.innerHTML = '♥';
                document.body.appendChild(circle);

                circle.addEventListener('animationend', () => {
                    circle.remove();
                });
            }
            
            function selectEffectOption(effectType) {
                effectOptions.forEach(option => {
                    option.classList.remove('selected');
                });
                
                const selectedOption = document.querySelector(`[data-effect="${effectType}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
            }
            
            function resetSettings() {
                textSize = 1;
                buttonScale = 1;
                isColorblindMode = false;
                isDarkTheme = false;
                currentBackground = 'default';
                currentEffect = 'none';
                
                colorblindToggle.checked = false;
                themeToggle.checked = false;
                
                document.body.classList.remove('colorblind-theme', 'dark-theme');
                applyBackground('default');
                selectBackgroundOption('default');
                applyEffect('none');
                selectEffectOption('none');
                
                updateTextSize();
                updateTextSizeIndicator();
                updateButtonSize();
                updateButtonSizeIndicator();
                
                localStorage.removeItem('textSize');
                localStorage.removeItem('buttonScale');
                localStorage.removeItem('colorblindMode');
                localStorage.removeItem('darkTheme');
                localStorage.removeItem('background');
                localStorage.removeItem('effect');
            }
            
            function downloadImage() {
                if (!currentImageUrl) return;
                
                const link = document.createElement('a');
                link.href = currentImageUrl;
                link.download = 'remake-ai-image.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            // Функция генерации изображения
            async function generateImage() {
                const prompt = document.getElementById('prompt').value.trim();
                
                if (!prompt) {
                    alert(currentLanguage === 'ru' ? 'Пожалуйста, опишите ваше изображение' : 'Please describe your image');
                    return;
                }
                
                if (!selectedStyle) {
                    alert(currentLanguage === 'ru' ? 'Пожалуйста, выберите стиль' : 'Please select a style');
                    return;
                }
                
                console.log('[START] Начинаем генерацию изображения...');
                console.log('Промпт:', prompt);
                console.log('Стиль:', selectedStyle);
                console.log('Вариация:', variationCount);
                
                loadingIndicator.style.display = 'block';
                previewPlaceholder.style.display = 'none';
                previewImage.style.display = 'none';
                downloadBtn.disabled = true;
                imageInfo.style.display = 'none';
                generateBtn.disabled = true;
                generateBtn.textContent = currentLanguage === 'ru' ? 'Генерация...' : 'Generating...';
                
                try {
                    const response = await fetch('/api/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            prompt: prompt,
                            style: selectedStyle,
                            variation: variationCount
                        })
                    });
                    
                    console.log('[RESPONSE] Ответ от сервера:', response.status);
                    
                    const data = await response.json();
                    console.log('[DATA] Данные ответа:', data);
                    
                    if (!response.ok) {
                        throw new Error(data.error || `HTTP error! status: ${response.status}`);
                    }
                    
                    if (data.success) {
                        loadingIndicator.style.display = 'none';
                        previewImage.style.display = 'block';
                        currentImageUrl = data.imageUrl;
                        previewImage.src = currentImageUrl;
                        previewImage.alt = (currentLanguage === 'ru' ? 'Сгенерированное изображение: ' : 'Generated image: ') + prompt;
                        
                        // Обновляем информацию об изображении
                        imageSource.textContent = data.source === 'prodia' ? 'Prodia AI' : 
                                                data.source === 'openrouter' ? 'OpenRouter' : 
                                                data.source === 'stability_ai' ? 'Stability AI' : 
                                                data.source === 'hugging_face' ? 'Hugging Face' : 
                                                data.source === 'fal_ai' ? 'Fal AI' : 
                                                data.source === 'enhanced_demo' ? 'Demo Mode' : 
                                                data.source;
                        imageModel.textContent = data.model || 'Unknown';
                        imageGenerationTime.textContent = data.generationTime || 'Unknown';
                        imageInfo.style.display = 'block';
                        
                        downloadBtn.disabled = false;
                        
                        // Увеличиваем счетчик вариаций для следующей генерации
                        variationCount++;
                        
                        // Сохраняем в историю (без base64 для экономии места)
                        try {
                            const generationHistory = JSON.parse(localStorage.getItem('generationHistory') || '[]');
                            
                            generationHistory.push({
                                prompt: prompt,
                                style: selectedStyle,
                                timestamp: new Date().toISOString(),
                                hasImage: data.imageUrl.startsWith('data:image/'),
                                source: data.source,
                                model: data.model,
                                variation: data.variation
                            });
                            
                            // Ограничиваем историю 10 последними записями
                            const limitedHistory = generationHistory.slice(-10);
                            localStorage.setItem('generationHistory', JSON.stringify(limitedHistory));
                        } catch (storageError) {
                            console.warn('[WARN] Не удалось сохранить историю:', storageError);
                        }
                        
                    } else {
                        throw new Error(data.error || 'Неизвестная ошибка');
                    }
                } catch (error) {
                    console.error('[ERROR] Ошибка генерации:', error);
                    loadingIndicator.style.display = 'none';
                    previewPlaceholder.style.display = 'flex';
                    previewPlaceholder.textContent = (currentLanguage === 'ru' ? 'Ошибка: ' : 'Error: ') + error.message;
                    previewPlaceholder.style.color = '#ff4444';
                    
                    setTimeout(() => {
                        previewPlaceholder.textContent = currentLanguage === 'ru' ? 
                            'Здесь появится ваше сгенерированное изображение' : 
                            'Your generated image will appear here';
                        previewPlaceholder.style.color = '';
                    }, 5000);
                } finally {
                    generateBtn.disabled = false;
                    generateBtn.textContent = currentLanguage === 'ru' ? 'Сгенерировать изображение' : 'Generate Image';
                }
            }

            // Инициализация обработчиков событий
            function initializeEventHandlers() {
                cellHeaders.forEach(header => {
                    header.addEventListener('click', function() {
                        const cellId = this.getAttribute('data-cell');
                        const content = document.getElementById(`${cellId}-cell`);
                        const arrow = this.querySelector('.cell-arrow');
                        
                        cellHeaders.forEach(h => {
                            if (h !== this) {
                                const otherCellId = h.getAttribute('data-cell');
                                const otherContent = document.getElementById(`${otherCellId}-cell`);
                                const otherArrow = h.querySelector('.cell-arrow');
                                
                                otherContent.classList.remove('active');
                                otherArrow.classList.remove('rotated');
                            }
                        });
                        
                        content.classList.toggle('active');
                        arrow.classList.toggle('rotated');
                    });
                });
                
                settingsBtn.addEventListener('click', function() {
                    settingsPanel.classList.toggle('active');
                });
                
                document.addEventListener('click', function(event) {
                    if (!settingsPanel.contains(event.target) && !settingsBtn.contains(event.target)) {
                        settingsPanel.classList.remove('active');
                    }
                    if (!languageDropdown.contains(event.target) && !languageBtn.contains(event.target)) {
                        languageDropdown.classList.remove('active');
                    }
                });
                
                languageBtn.addEventListener('click', function() {
                    languageDropdown.classList.toggle('active');
                });
                
                languageOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const lang = this.getAttribute('data-lang');
                        setLanguage(lang);
                        languageDropdown.classList.remove('active');
                    });
                });
                
                decreaseTextBtn.addEventListener('click', function() {
                    if (textSize > 0.8) {
                        textSize -= 0.1;
                        updateTextSize();
                        updateTextSizeIndicator();
                    }
                });
                
                increaseTextBtn.addEventListener('click', function() {
                    if (textSize < 1.5) {
                        textSize += 0.1;
                        updateTextSize();
                        updateTextSizeIndicator();
                    }
                });
                
                decreaseButtonsBtn.addEventListener('click', function() {
                    if (buttonScale > 0.8) {
                        buttonScale -= 0.1;
                        updateButtonSize();
                        updateButtonSizeIndicator();
                    }
                });
                
                increaseButtonsBtn.addEventListener('click', function() {
                    if (buttonScale < 1.5) {
                        buttonScale += 0.1;
                        updateButtonSize();
                        updateButtonSizeIndicator();
                    }
                });
                
                colorblindToggle.addEventListener('change', function() {
                    isColorblindMode = this.checked;
                    if (isColorblindMode) {
                        document.body.classList.add('colorblind-theme');
                    } else {
                        document.body.classList.remove('colorblind-theme');
                    }
                    localStorage.setItem('colorblindMode', isColorblindMode);
                });
                
                themeToggle.addEventListener('change', function() {
                    isDarkTheme = this.checked;
                    if (isDarkTheme) {
                        document.body.classList.add('dark-theme');
                    } else {
                        document.body.classList.remove('dark-theme');
                    }
                    
                    // Обновляем фон при смене темы
                    if (currentBackground.startsWith('pattern')) {
                        applyBackground(currentBackground);
                    }
                    
                    localStorage.setItem('darkTheme', isDarkTheme);
                });
                
                backgroundOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const bgType = this.getAttribute('data-bg');
                        currentBackground = bgType;
                        applyBackground(bgType);
                        selectBackgroundOption(bgType);
                    });
                });
                
                effectOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const effectType = this.getAttribute('data-effect');
                        currentEffect = effectType;
                        applyEffect(effectType);
                        selectEffectOption(effectType);
                    });
                });
                
                resetSettingsBtn.addEventListener('click', resetSettings);
                
                downloadBtn.addEventListener('click', downloadImage);
                
                styleOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        styleOptions.forEach(opt => opt.classList.remove('selected'));
                        this.classList.add('selected');
                        selectedStyle = this.getAttribute('data-style');
                        // Сбрасываем счетчик вариаций при смене стиля
                        variationCount = 0;
                    });
                });
                
                generateBtn.addEventListener('click', generateImage);
                
                // Добавляем возможность генерации по Ctrl+Enter
                document.getElementById('prompt').addEventListener('keydown', function(e) {
                    if (e.ctrlKey && e.key === 'Enter') {
                        generateImage();
                    }
                });
                
                // Сбрасываем счетчик вариаций при изменении промпта
                document.getElementById('prompt').addEventListener('input', function() {
                    variationCount = 0;
                });
            }

            // Основная инициализация
            function initialize() {
                initializeSettings();
                initializeEventHandlers();
                
                // Автоматически выбираем первый стиль
                if (styleOptions.length > 0) {
                    styleOptions[0].classList.add('selected');
                }
                
                console.log('[OK] Frontend initialized successfully');
                console.log('[TIP] Tips:');
                console.log('   - Use Ctrl+Enter to generate image quickly');
                console.log('   - Each generation creates a unique variation');
                console.log('   - Check browser console for detailed logs');
            }

            // Запускаем инициализацию
            initialize();
        });
    </script>
</body>
</html>